{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/mohdashraf/Desktop/searchbox/packages/native/examples/with-transform-request-prop/App.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useRef } from 'react';\nimport { SearchBase, SearchComponent, SearchBox } from '@appbaseio/react-native-searchbox';\nimport { AntDesign } from '@expo/vector-icons';\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport StatusBar from \"react-native-web/dist/exports/StatusBar\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport axios from 'axios';\n\nvar renderResultItem = function renderResultItem(_ref) {\n  var item = _ref.item;\n  return React.createElement(View, {\n    style: styles.itemStyle,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 23,\n      columnNumber: 5\n    }\n  }, React.createElement(Image, {\n    style: styles.image,\n    source: {\n      uri: item.image\n    },\n    resizeMode: \"contain\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 24,\n      columnNumber: 7\n    }\n  }), React.createElement(View, {\n    style: {\n      flex: 1\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 31,\n      columnNumber: 7\n    }\n  }, React.createElement(Text, {\n    style: styles.textStyle,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 32,\n      columnNumber: 9\n    }\n  }, item.original_title), React.createElement(Text, {\n    style: styles.textStyle,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 33,\n      columnNumber: 9\n    }\n  }, \"by \", item.authors), React.createElement(View, {\n    style: styles.star,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 34,\n      columnNumber: 9\n    }\n  }, Array(item.average_rating_rounded).fill('x').map(function (i, index) {\n    return React.createElement(AntDesign, {\n      key: item._id + (\"_\" + index),\n      name: \"star\",\n      size: 24,\n      color: \"gold\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 38,\n        columnNumber: 15\n      }\n    });\n  }), React.createElement(Text, {\n    style: styles.rating,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 11\n    }\n  }, \"(\", item.average_rating, \" avg)\")), React.createElement(Text, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 9\n    }\n  }, \"Pub \", item.original_publication_year)));\n};\n\nvar renderItemSeparator = function renderItemSeparator() {\n  return React.createElement(View, {\n    style: styles.itemSeparator,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 5\n    }\n  });\n};\n\nexport default function App() {\n  var _this2 = this;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      dataSource = _useState2[0],\n      setDataSource = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      resetPagination = _useState4[0],\n      setResetPagination = _useState4[1];\n\n  var stateRef = useRef();\n  stateRef.current = dataSource;\n  var stateRefQuery = useRef();\n  stateRefQuery.current = resetPagination;\n\n  var setResults = function setResults(results) {\n    if (stateRefQuery.current) {\n      setDataSource(results.data);\n      setResetPagination(false);\n    } else {\n      setDataSource([].concat(_toConsumableArray(stateRef.current), _toConsumableArray(results.data)));\n    }\n  };\n\n  return React.createElement(SafeAreaView, {\n    style: styles.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 5\n    }\n  }, React.createElement(SearchBase, {\n    index: \"good-books-ds\",\n    credentials: \"a03a1cb71321:75b6603d-9456-4a5a-af6b-a487b309eb61\",\n    url: \"https://appbase-demo-ansible-abxiydt-arc.searchbase.io\",\n    appbaseConfig: {\n      recordAnalytics: true,\n      enableQueryRules: true,\n      userId: 'jon@appbase.io',\n      customEvents: {\n        platform: 'ios',\n        device: 'iphoneX'\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 7\n    }\n  }, React.createElement(SearchBox, {\n    id: \"search-component\",\n    dataField: [{\n      field: 'original_title',\n      weight: 1\n    }, {\n      field: 'original_title.search',\n      weight: 3\n    }],\n    transformRequest: function transformRequest(request) {\n      var suggestedWordsList = [];\n      var reqBody = JSON.parse(request.body);\n      var url = 'https://api.datamuse.com/words?sp=' + reqBody.query[0].value + '&max=2';\n      return axios.get(url).then(function (_ref2) {\n        var data = _ref2.data;\n\n        if (data.length > 0) {\n          suggestedWordsList.push(data[0].word);\n        }\n\n        if (suggestedWordsList.length) {\n          reqBody.query[0].value = suggestedWordsList[0];\n        }\n\n        var newRequest = _objectSpread(_objectSpread({}, request), {}, {\n          body: JSON.stringify(reqBody)\n        });\n\n        return Promise.resolve(newRequest);\n      }).catch(function (err) {\n        return console.error(err);\n      }).finally(function () {\n        if (!suggestedWordsList.length) {\n          return Promise.resolve(request);\n        }\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 9\n    }\n  }), React.createElement(SearchComponent, {\n    id: \"result-component\",\n    dataField: \"original_title\",\n    size: 10,\n    react: {\n      and: ['search-component']\n    },\n    onResults: setResults,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 9\n    }\n  }, function (_ref3) {\n    var results = _ref3.results,\n        loading = _ref3.loading,\n        size = _ref3.size,\n        from = _ref3.from,\n        setValue = _ref3.setValue,\n        setFrom = _ref3.setFrom;\n    return React.createElement(View, {\n      __self: _this2,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 15\n      }\n    }, loading && !results.data.length ? React.createElement(ActivityIndicator, {\n      style: styles.loader,\n      size: \"large\",\n      color: \"#000\",\n      __self: _this2,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 19\n      }\n    }) : React.createElement(View, {\n      __self: _this2,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 19\n      }\n    }, !results.data.length ? React.createElement(Text, {\n      style: styles.resultStats,\n      __self: _this2,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 23\n      }\n    }, \"No results found\") : React.createElement(View, {\n      style: styles.resultContainer,\n      __self: _this2,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 23\n      }\n    }, React.createElement(Text, {\n      style: styles.resultStats,\n      __self: _this2,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 25\n      }\n    }, results.numberOfResults, \" results found in\", ' ', results.time, \"ms\"), React.createElement(FlatList, {\n      data: dataSource,\n      keyboardShouldPersistTaps: 'handled',\n      keyExtractor: function keyExtractor(item) {\n        return item._id;\n      },\n      ItemSeparatorComponent: renderItemSeparator,\n      renderItem: renderResultItem,\n      onEndReached: function onEndReached() {\n        var offset = (from || 0) + size;\n\n        if (results.numberOfResults > offset) {\n          setFrom((from || 0) + size);\n        }\n      },\n      onEndReachedThreshold: 0.5,\n      ListFooterComponent: loading ? React.createElement(ActivityIndicator, {\n        size: \"large\",\n        color: \"#000\",\n        __self: _this2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 31\n        }\n      }) : null,\n      __self: _this2,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 25\n      }\n    }))));\n  })));\n}\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#fff',\n    paddingTop: Platform.OS === 'android' ? StatusBar.currentHeight : 0\n  },\n  loader: {\n    marginTop: 50\n  },\n  itemSeparator: {\n    height: 0.5,\n    width: '100%',\n    backgroundColor: '#C8C8C8'\n  },\n  image: {\n    width: 100,\n    marginRight: 10\n  },\n  itemStyle: {\n    flex: 1,\n    flexDirection: 'row',\n    padding: 10,\n    height: 170\n  },\n  star: {\n    flexDirection: 'row',\n    paddingBottom: 5\n  },\n  textStyle: {\n    flexWrap: 'wrap',\n    paddingBottom: 5\n  },\n  resultStats: {\n    padding: 10\n  },\n  rating: {\n    marginLeft: 10\n  }\n});","map":{"version":3,"sources":["/Users/mohdashraf/Desktop/searchbox/packages/native/examples/with-transform-request-prop/App.js"],"names":["React","useState","useRef","SearchBase","SearchComponent","SearchBox","AntDesign","axios","renderResultItem","item","styles","itemStyle","image","uri","flex","textStyle","original_title","authors","star","Array","average_rating_rounded","fill","map","i","index","_id","rating","average_rating","original_publication_year","renderItemSeparator","itemSeparator","App","dataSource","setDataSource","resetPagination","setResetPagination","stateRef","current","stateRefQuery","setResults","results","data","container","recordAnalytics","enableQueryRules","userId","customEvents","platform","device","field","weight","request","suggestedWordsList","reqBody","JSON","parse","body","url","query","value","get","then","length","push","word","newRequest","stringify","Promise","resolve","catch","err","console","error","finally","and","loading","size","from","setValue","setFrom","loader","resultStats","resultContainer","numberOfResults","time","offset","StyleSheet","create","backgroundColor","paddingTop","Platform","OS","StatusBar","currentHeight","marginTop","height","width","marginRight","flexDirection","padding","paddingBottom","flexWrap","marginLeft"],"mappings":"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","sourcesContent":["import React, { useState, useRef } from 'react';\nimport {\n  SearchBase,\n  SearchComponent,\n  SearchBox\n} from '@appbaseio/react-native-searchbox';\nimport { AntDesign } from '@expo/vector-icons';\nimport {\n  StyleSheet,\n  Text,\n  View,\n  Platform,\n  StatusBar,\n  ActivityIndicator,\n  FlatList,\n  Image,\n  SafeAreaView\n} from 'react-native';\nimport axios from 'axios';\n\nconst renderResultItem = ({ item }) => {\n  return (\n    <View style={styles.itemStyle}>\n      <Image\n        style={styles.image}\n        source={{\n          uri: item.image\n        }}\n        resizeMode=\"contain\"\n      />\n      <View style={{ flex: 1 }}>\n        <Text style={styles.textStyle}>{item.original_title}</Text>\n        <Text style={styles.textStyle}>by {item.authors}</Text>\n        <View style={styles.star}>\n          {Array(item.average_rating_rounded)\n            .fill('x')\n            .map((i, index) => (\n              <AntDesign\n                key={item._id + `_${index}`}\n                name=\"star\"\n                size={24}\n                color=\"gold\"\n              />\n            ))}\n          <Text style={styles.rating}>({item.average_rating} avg)</Text>\n        </View>\n        <Text>Pub {item.original_publication_year}</Text>\n      </View>\n    </View>\n  );\n};\n\nconst renderItemSeparator = () => {\n  return (\n    // Flat List Item Separator\n    <View style={styles.itemSeparator} />\n  );\n};\n\nexport default function App() {\n  const [dataSource, setDataSource] = useState([]);\n  const [resetPagination, setResetPagination] = useState(false);\n  const stateRef = useRef();\n  stateRef.current = dataSource;\n  const stateRefQuery = useRef();\n  stateRefQuery.current = resetPagination;\n  const setResults = results => {\n    if (stateRefQuery.current) {\n      // Reset paginated data source\n      setDataSource(results.data);\n      setResetPagination(false);\n    } else {\n      setDataSource([...stateRef.current, ...results.data]);\n    }\n  };\n  return (\n    <SafeAreaView style={styles.container}>\n      <SearchBase\n        index=\"good-books-ds\"\n        credentials=\"a03a1cb71321:75b6603d-9456-4a5a-af6b-a487b309eb61\"\n        url=\"https://appbase-demo-ansible-abxiydt-arc.searchbase.io\"\n        appbaseConfig={{\n          recordAnalytics: true,\n          enableQueryRules: true,\n          userId: 'jon@appbase.io',\n          customEvents: {\n            platform: 'ios',\n            device: 'iphoneX'\n          }\n        }}\n      >\n        <SearchBox\n          id=\"search-component\"\n          dataField={[\n            {\n              field: 'original_title',\n              weight: 1\n            },\n            {\n              field: 'original_title.search',\n              weight: 3\n            }\n          ]}\n          // onValueSelected={value => {\n          //   setResetPagination(true);\n          // }}\n          transformRequest={request => {\n            const suggestedWordsList = [];\n            let reqBody = JSON.parse(request.body);\n            let url =\n              'https://api.datamuse.com/words?sp=' +\n              reqBody.query[0].value +\n              '&max=2';\n            return (\n              axios\n                .get(url)\n                .then(({ data }) => {\n                  if (data.length > 0) {\n                    suggestedWordsList.push(data[0].word);\n                  }\n                  if (suggestedWordsList.length) {\n                    reqBody.query[0].value = suggestedWordsList[0];\n                  }\n                  let newRequest = {\n                    ...request,\n                    body: JSON.stringify(reqBody)\n                  };\n                  return Promise.resolve(newRequest);\n                })\n                .catch(err => console.error(err))\n                // eslint-disable-next-line\n              .finally(() => {\n                  if (!suggestedWordsList.length) {\n                    return Promise.resolve(request);\n                  }\n                })\n            );\n          }}\n        />\n        <SearchComponent\n          id=\"result-component\"\n          dataField=\"original_title\"\n          size={10}\n          react={{\n            and: ['search-component']\n          }}\n          onResults={setResults}\n        >\n          {({ results, loading, size, from, setValue, setFrom }) => {\n            return (\n              <View>\n                {loading && !results.data.length ? (\n                  <ActivityIndicator\n                    style={styles.loader}\n                    size=\"large\"\n                    color=\"#000\"\n                  />\n                ) : (\n                  <View>\n                    {!results.data.length ? (\n                      <Text style={styles.resultStats}>No results found</Text>\n                    ) : (\n                      <View style={styles.resultContainer}>\n                        <Text style={styles.resultStats}>\n                          {results.numberOfResults} results found in{' '}\n                          {results.time}ms\n                        </Text>\n                        <FlatList\n                          data={dataSource}\n                          keyboardShouldPersistTaps={'handled'}\n                          keyExtractor={item => item._id}\n                          ItemSeparatorComponent={renderItemSeparator}\n                          renderItem={renderResultItem}\n                          onEndReached={() => {\n                            const offset = (from || 0) + size;\n                            if (results.numberOfResults > offset) {\n                              setFrom((from || 0) + size);\n                            }\n                          }}\n                          onEndReachedThreshold={0.5}\n                          ListFooterComponent={\n                            loading ? (\n                              <ActivityIndicator size=\"large\" color=\"#000\" />\n                            ) : null\n                          }\n                        />\n                      </View>\n                    )}\n                  </View>\n                )}\n              </View>\n            );\n          }}\n        </SearchComponent>\n      </SearchBase>\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#fff',\n    paddingTop: Platform.OS === 'android' ? StatusBar.currentHeight : 0\n  },\n  loader: {\n    marginTop: 50\n  },\n  itemSeparator: {\n    height: 0.5,\n    width: '100%',\n    backgroundColor: '#C8C8C8'\n  },\n  image: {\n    width: 100,\n    marginRight: 10\n  },\n  itemStyle: {\n    flex: 1,\n    flexDirection: 'row',\n    padding: 10,\n    height: 170\n  },\n  star: {\n    flexDirection: 'row',\n    paddingBottom: 5\n  },\n  textStyle: {\n    flexWrap: 'wrap',\n    paddingBottom: 5\n  },\n  resultStats: {\n    padding: 10\n  },\n  rating: {\n    marginLeft: 10\n  }\n});\n"]},"metadata":{},"sourceType":"module"}