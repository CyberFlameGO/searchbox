{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _extends from \"@babel/runtime/helpers/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\n\nvar _jsxFileName = \"/Users/mohdashraf/Desktop/searchbox/node_modules/@appbaseio/react-native-searchbox/src/components/SearchBox/index.js\",\n    _this4 = this;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React from 'react';\nimport { any, bool, func, number, object, string, arrayOf, array, oneOfType } from 'prop-types';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport Modal from \"react-native-web/dist/exports/Modal\";\nimport Pressable from \"react-native-web/dist/exports/Pressable\";\nimport KeyboardAvoidingView from \"react-native-web/dist/exports/KeyboardAvoidingView\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport { appbaseConfig as appbaseConfigDef, fuzziness as fuzzinessDef, queryFormat, title as titleDef, wholeNumber, dataField as dataFieldDef } from \"../../utils/types\";\nimport Icon from \"./SearchBar/Icon\";\nimport { renderNode, nodeType } from \"./SearchBar/helpers\";\nimport defaultTheme from \"./SearchBar/helpers/theme\";\nimport SearchComponent from \"../SearchComponent\";\nimport { debounce as debounceFunc, equals, getComponent, hasCustomRenderer, SearchContext, isFunction } from \"../../utils/helper\";\nimport SearchBar from \"./SearchBar\";\nimport causes from \"../../utils/causes\";\n\nvar defaultGoBackIcon = function defaultGoBackIcon(theme) {\n  return {\n    type: 'ionicon',\n    size: 24,\n    name: 'ios-arrow-back'\n  };\n};\n\nvar defaultRecentSearchIcon = function defaultRecentSearchIcon(theme) {\n  return {\n    type: 'material',\n    size: 24,\n    name: 'history'\n  };\n};\n\nvar defaultPopularSuggestionIcon = function defaultPopularSuggestionIcon(theme) {\n  return {\n    type: 'material',\n    size: 24,\n    name: 'trending-up',\n    style: {\n      marginRight: 10\n    }\n  };\n};\n\nvar defaultAutoFillIcon = function defaultAutoFillIcon(theme) {\n  return {\n    type: 'feather',\n    size: 24,\n    name: 'arrow-up-left'\n  };\n};\n\nvar SearchBox = function (_React$Component) {\n  _inherits(SearchBox, _React$Component);\n\n  var _super = _createSuper(SearchBox);\n\n  function SearchBox(props, context) {\n    var _this;\n\n    _classCallCheck(this, SearchBox);\n\n    _this = _super.call(this, props, context);\n\n    _this.closeModal = function () {\n      var _this$state = _this.state,\n          showModal = _this$state.showModal,\n          autoFillInProgress = _this$state.autoFillInProgress;\n\n      if (showModal) {\n        _this.clearState(function () {\n          if (autoFillInProgress) {\n            _this.setValue({\n              value: ''\n            });\n          }\n        });\n      }\n    };\n\n    _this.openModal = function () {\n      var enableRecentSearches = _this.props.enableRecentSearches;\n      var showModal = _this.state.showModal;\n\n      if (!showModal) {\n        _this.setState({\n          showModal: true\n        }, _this.setFocus);\n\n        if (enableRecentSearches) {\n          if (!_this.componentInstance.value) {\n            _this.componentInstance.clearResults();\n\n            _this.componentInstance.getRecentSearches();\n          }\n        }\n      }\n    };\n\n    _this._applySetter = function (prev, next, setterFunc) {\n      if (!equals(prev, next)) _this.componentInstance && _this.componentInstance[setterFunc](next);\n    };\n\n    _this.getComponent = function () {\n      var isPopularSuggestionsRender = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var _this$props = _this.props,\n          error = _this$props.error,\n          loading = _this$props.loading,\n          recentSearches = _this$props.recentSearches;\n      var data = {\n        error: error,\n        loading: loading,\n        data: _this.suggestionsList,\n        value: _this.componentInstance.value,\n        triggerClickAnalytics: _this.triggerClickAnalytics,\n        promotedData: _this.componentInstance.results.promotedData,\n        customData: _this.componentInstance.results.customData,\n        resultStats: _this.stats,\n        rawData: _this.componentInstance.results.rawData,\n        popularSuggestions: _this.popularSuggestionsList,\n        recentSearches: recentSearches\n      };\n      return getComponent(data, _this.props);\n    };\n\n    _this.triggerClickAnalytics = function (clickPosition) {\n      var isSuggestion = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n      var value = arguments.length > 2 ? arguments[2] : undefined;\n      var appbaseConfig = _this.props.appbaseConfig;\n      if (!(appbaseConfig && appbaseConfig.recordAnalytics) || !_this.componentInstance) return;\n\n      _this.componentInstance.recordClick(_defineProperty({}, value, clickPosition), isSuggestion);\n    };\n\n    _this.triggerQuery = function () {\n      _this.componentInstance && _this.componentInstance.setValue(_this.props.value, {\n        triggerCustomQuery: true,\n        stateChanges: true\n      });\n    };\n\n    _this.triggerCustomQuery = function () {\n      if (_this.componentInstance) {\n        _this.componentInstance.triggerCustomQuery();\n      }\n    };\n\n    _this.triggerDefaultQuery = function () {\n      _this.componentInstance && _this.componentInstance.triggerDefaultQuery();\n    };\n\n    _this.onInputChange = function (value) {\n      _this.setValue({\n        value: value\n      });\n    };\n\n    _this.scrollToTop = function () {\n      _this.flatListRef.current && _this.flatListRef.current.scrollToOffset({\n        animated: true,\n        offset: 0\n      });\n    };\n\n    _this.isControlled = function () {\n      var _this$props2 = _this.props,\n          value = _this$props2.value,\n          onChange = _this$props2.onChange;\n\n      if (value !== undefined && onChange) {\n        return true;\n      }\n\n      return false;\n    };\n\n    _this.setValue = function (_ref) {\n      var value = _ref.value,\n          _ref$clearResults = _ref.clearResults,\n          clearResults = _ref$clearResults === void 0 ? true : _ref$clearResults,\n          rest = _objectWithoutProperties(_ref, [\"value\", \"clearResults\"]);\n\n      var triggerDefaultQuery = true;\n      var autoFillInProgress = _this.state.autoFillInProgress;\n      var _this$props3 = _this.props,\n          onChange = _this$props3.onChange,\n          debounce = _this$props3.debounce,\n          autosuggest = _this$props3.autosuggest;\n\n      if (!autosuggest) {\n        triggerDefaultQuery = false;\n      } else if (rest.triggerDefaultQuery !== undefined) {\n        triggerDefaultQuery = rest.triggerDefaultQuery;\n      }\n\n      if (autoFillInProgress) {\n        _this.setState({\n          autoFillInProgress: false\n        });\n      }\n\n      if (_this.isControlled()) {\n        _this.componentInstance.setValue(value, {\n          triggerDefaultQuery: !!rest.triggerDefaultQuery,\n          triggerCustomQuery: !!rest.triggerCustomQuery\n        });\n\n        onChange(value, _this.componentInstance);\n      } else {\n        if (!value && clearResults) {\n          _this.componentInstance.clearResults();\n        }\n\n        if (debounce > 0) {\n          _this.componentInstance.setValue(value, {\n            triggerDefaultQuery: false,\n            triggerCustomQuery: false,\n            stateChanges: true\n          });\n\n          if (value && triggerDefaultQuery) {\n            debounceFunc(_this.triggerDefaultQuery, debounce);\n          }\n\n          if (!autosuggest) {\n            debounceFunc(_this.triggerCustomQuery, debounce);\n          }\n\n          if (rest.triggerCustomQuery) {\n            _this.triggerCustomQuery();\n          }\n        } else {\n          _this.componentInstance.setValue(value || '', {\n            triggerCustomQuery: rest.triggerCustomQuery,\n            triggerDefaultQuery: !!value && triggerDefaultQuery,\n            stateChanges: true\n          });\n\n          if (!autosuggest) {\n            _this.triggerCustomQuery();\n          }\n        }\n      }\n    };\n\n    _this.onValueSelected = function () {\n      var currentValue = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : _this.componentInstance.value;\n      var onValueSelected = _this.props.onValueSelected;\n\n      if (onValueSelected) {\n        for (var _len = arguments.length, cause = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n          cause[_key - 1] = arguments[_key];\n        }\n\n        onValueSelected.apply(void 0, [currentValue].concat(cause));\n      }\n    };\n\n    _this.clearValue = function () {\n      _this.setValue({\n        value: '',\n        triggerCustomQuery: true\n      });\n\n      _this.onValueSelected(null, causes.CLEAR_VALUE);\n    };\n\n    _this.onSuggestionSelected = function (suggestion) {\n      _this.setValue({\n        value: suggestion && suggestion.value,\n        triggerCustomQuery: true\n      });\n\n      _this.closeModal();\n\n      _this.triggerClickAnalytics(suggestion && suggestion._click_id, true, suggestion.source && suggestion.source._id);\n\n      _this.onValueSelected(suggestion.value, causes.SUGGESTION_SELECT, suggestion.source);\n    };\n\n    _this.renderNoSuggestion = function () {\n      var _this$props4 = _this.props,\n          renderNoSuggestion = _this$props4.renderNoSuggestion,\n          loading = _this$props4.loading,\n          error = _this$props4.error;\n      var currentValue = _this.componentInstance.value;\n\n      if (renderNoSuggestion && !_this.totalSuggestions.length && !loading && currentValue && !error) {\n        return typeof renderNoSuggestion === 'function' ? renderNoSuggestion(currentValue) : renderNoSuggestion;\n      }\n\n      return null;\n    };\n\n    _this.clearState = function () {\n      var cb = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : function () {\n        return null;\n      };\n\n      _this.setState({\n        showModal: false,\n        autoFillInProgress: false\n      }, cb);\n    };\n\n    _this.handleSubmitEditing = function (e) {\n      var text = e.nativeEvent.text;\n\n      _this.clearState(function () {\n        return _this.setValue({\n          value: text,\n          triggerCustomQuery: true\n        });\n      });\n\n      _this.onValueSelected(text, causes.ENTER_PRESS);\n    };\n\n    _this.handleAutoFill = function (item, recentSearch) {\n      _this.setState({\n        autoFillInProgress: true\n      }, function () {\n        _this.componentInstance.setValue(item.value);\n      });\n    };\n\n    _this.withTriggerQuery = function (cb) {\n      if (cb) {\n        return function (e) {\n          return cb(_this.componentInstance, e);\n        };\n      }\n\n      return undefined;\n    };\n\n    _this.renderSuggestionItem = function (_ref2) {\n      var item = _ref2.item,\n          isRecentSearch = _ref2.isRecentSearch;\n      var _this$props5 = _this.props,\n          renderItem = _this$props5.renderItem,\n          theme = _this$props5.theme,\n          _this$props5$autoFill = _this$props5.autoFillIcon,\n          autoFillIcon = _this$props5$autoFill === void 0 ? defaultAutoFillIcon(theme) : _this$props5$autoFill,\n          showAutoFill = _this$props5.showAutoFill,\n          _this$props5$recentSe = _this$props5.recentSearchIcon,\n          recentSearchIcon = _this$props5$recentSe === void 0 ? defaultRecentSearchIcon(theme) : _this$props5$recentSe,\n          _this$props5$popularS = _this$props5.popularSuggestionIcon,\n          popularSuggestionIcon = _this$props5$popularS === void 0 ? defaultPopularSuggestionIcon(theme) : _this$props5$popularS;\n      var isPredictiveSuggestion = item.isPredictiveSuggestion;\n      var normalText = '';\n      var highlightedText = '';\n\n      if (isPredictiveSuggestion) {\n        normalText = /[^<]*/.exec(item.label)[0];\n        highlightedText = />[^<]*/.exec(item.label)[0].replaceAll('>', '');\n      }\n\n      if (renderItem) {\n        return renderItem(item, isRecentSearch);\n      }\n\n      return React.createElement(View, {\n        style: styles.itemStyle,\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 577,\n          columnNumber: 7\n        }\n      }, isRecentSearch ? renderNode(Icon, recentSearchIcon, _objectSpread({\n        theme: theme,\n        onPress: function onPress() {\n          return _this.onSuggestionSelected(item);\n        }\n      }, defaultRecentSearchIcon(theme))) : null, item.source && item.source._popular_suggestion ? renderNode(Icon, popularSuggestionIcon, _objectSpread({\n        theme: theme,\n        onPress: function onPress() {\n          return _this.onSuggestionSelected(item);\n        }\n      }, defaultPopularSuggestionIcon(theme))) : null, isPredictiveSuggestion ? React.createElement(TouchableOpacity, {\n        style: {\n          display: 'flex',\n          flexDirection: 'row',\n          flex: 1\n        },\n        onPress: function onPress() {\n          return _this.onSuggestionSelected(item);\n        },\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 593,\n          columnNumber: 11\n        }\n      }, React.createElement(Text, {\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 594,\n          columnNumber: 13\n        }\n      }, normalText), React.createElement(Text, {\n        style: {\n          fontWeight: '700'\n        },\n        numberOfLines: 1,\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 595,\n          columnNumber: 13\n        }\n      }, highlightedText)) : React.createElement(Text, {\n        style: styles.itemText,\n        onPress: function onPress() {\n          return _this.onSuggestionSelected(item);\n        },\n        numberOfLines: 1,\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 598,\n          columnNumber: 11\n        }\n      }, item.label), React.createElement(View, {\n        styles: styles.autoFillIcon,\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 606,\n          columnNumber: 9\n        }\n      }, showAutoFill ? renderNode(Icon, autoFillIcon, _objectSpread({\n        theme: theme,\n        onPress: function onPress() {\n          return _this.handleAutoFill(item, isRecentSearch);\n        }\n      }, defaultAutoFillIcon(theme))) : null));\n    };\n\n    _this.renderItemSeparator = function () {\n      var _this$props6 = _this.props,\n          separatorStyle = _this$props6.separatorStyle,\n          theme = _this$props6.theme;\n      return React.createElement(View, {\n        style: StyleSheet.flatten([styles.itemSeparator(theme), separatorStyle]),\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 623,\n          columnNumber: 7\n        }\n      });\n    };\n\n    _this.renderError = function () {\n      var _this$props7 = _this.props,\n          renderError = _this$props7.renderError,\n          error = _this$props7.error,\n          loading = _this$props7.loading;\n\n      if (error && renderError && !loading) {\n        return isFunction(renderError) ? renderError(error) : renderError;\n      }\n\n      return null;\n    };\n\n    var _value = props.value,\n        defaultValue = props.defaultValue;\n\n    var _currentValue = _value || defaultValue || '';\n\n    _this.state = {\n      showModal: false,\n      autoFillInProgress: false\n    };\n\n    if (_currentValue) {\n      _this.componentInstance.setValue(_currentValue, {\n        triggerDefaultQuery: false,\n        triggerCustomQuery: true,\n        stateChanges: true\n      });\n    }\n\n    if (_this.componentInstance) {\n      var onResults = function onResults() {\n        _this.scrollToTop();\n      };\n\n      if (_this.componentInstance.onResults) {\n        _this.componentInstance.onResults = function () {\n          onResults();\n\n          _this.componentInstance.onResults();\n        };\n      } else {\n        _this.componentInstance.onResults = onResults;\n      }\n    }\n\n    _this.searchbarRef = React.createRef();\n    _this.flatListRef = React.createRef();\n    return _this;\n  }\n\n  _createClass(SearchBox, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var aggregationField = this.props.aggregationField;\n\n      if (aggregationField) {\n        console.warn('Warning(SearchBox): The `aggregationField` prop has been marked as deprecated, please use the `distinctField` prop instead.');\n      }\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      var _this$props8 = this.props,\n          dataField = _this$props8.dataField,\n          headers = _this$props8.headers,\n          fuzziness = _this$props8.fuzziness,\n          nestedField = _this$props8.nestedField,\n          appbaseConfig = _this$props8.appbaseConfig;\n\n      this._applySetter(prevProps.dataField, dataField, 'setDataField');\n\n      this._applySetter(prevProps.headers, headers, 'setHeaders');\n\n      this._applySetter(prevProps.fuzziness, fuzziness, 'setFuzziness');\n\n      this._applySetter(prevProps.nestedField, nestedField, 'setNestedField');\n\n      if (JSON.stringify(prevProps.appbaseConfig) !== JSON.stringify(appbaseConfig)) {\n        if (this.componentInstance) this.componentInstance.appbaseConfig = appbaseConfig;\n      }\n    }\n  }, {\n    key: \"setFocus\",\n    value: function setFocus() {\n      var _this2 = this;\n\n      setTimeout(function () {\n        if (_this2.searchbarRef.current) {\n          _this2.searchbarRef.current.focus();\n        }\n      }, 40);\n    }\n  }, {\n    key: \"renderSearchInput\",\n    value: function renderSearchInput() {\n      var _ref3 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n          _ref3$isOpenWithModal = _ref3.isOpenWithModal,\n          isOpenWithModal = _ref3$isOpenWithModal === void 0 ? false : _ref3$isOpenWithModal,\n          rest = _objectWithoutProperties(_ref3, [\"isOpenWithModal\"]);\n\n      var _this$props9 = this.props,\n          placeholder = _this$props9.placeholder,\n          theme = _this$props9.theme,\n          loading = _this$props9.loading,\n          style = _this$props9.style,\n          searchBarProps = _this$props9.searchBarProps,\n          onBlur = _this$props9.onBlur,\n          onKeyPress = _this$props9.onKeyPress,\n          onFocus = _this$props9.onFocus;\n      var currentValue = this.componentInstance.value || '';\n      return React.createElement(SearchBar, _extends({\n        onChangeText: this.onInputChange,\n        onSubmitEditing: this.handleSubmitEditing,\n        onClear: this.clearValue,\n        placeholder: placeholder,\n        value: currentValue,\n        autoFocus: isOpenWithModal,\n        theme: theme,\n        showLoading: loading,\n        returnKeyType: \"search\",\n        ref: this.searchbarRef,\n        style: style,\n        onBlur: this.withTriggerQuery(onBlur),\n        onFocus: this.withTriggerQuery(onFocus),\n        onKeyPress: this.withTriggerQuery(onKeyPress)\n      }, rest, searchBarProps, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 449,\n          columnNumber: 7\n        }\n      }));\n    }\n  }, {\n    key: \"renderAutoSuggestView\",\n    value: function renderAutoSuggestView() {\n      var _this3 = this;\n\n      var _this$props10 = this.props,\n          theme = _this$props10.theme,\n          _this$props10$goBackI = _this$props10.goBackIcon,\n          goBackIcon = _this$props10$goBackI === void 0 ? defaultGoBackIcon(theme) : _this$props10$goBackI,\n          size = _this$props10.size,\n          searchHeaderStyle = _this$props10.searchHeaderStyle,\n          recentSearches = _this$props10.recentSearches,\n          suggestionsContainerStyle = _this$props10.suggestionsContainerStyle;\n      return React.createElement(Modal, {\n        supportedOrientations: null,\n        transparent: false,\n        visible: this.state.showModal,\n        onRequestClose: this.closeModal,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 480,\n          columnNumber: 7\n        }\n      }, React.createElement(SafeAreaView, {\n        style: styles.flex1,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 486,\n          columnNumber: 9\n        }\n      }, React.createElement(View, {\n        style: styles.flex1,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 487,\n          columnNumber: 11\n        }\n      }, React.createElement(View, {\n        style: StyleSheet.flatten([styles.searchHeaderStyle(theme), searchHeaderStyle]),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 488,\n          columnNumber: 13\n        }\n      }, renderNode(Icon, goBackIcon, _objectSpread(_objectSpread({\n        theme: theme\n      }, defaultGoBackIcon(theme)), {}, {\n        onPress: this.closeModal\n      }))), this.renderSearchInput({\n        isOpenWithModal: true\n      }), this.hasCustomRenderer ? React.createElement(KeyboardAvoidingView, {\n        behavior: Platform.OS === 'ios' ? 'padding' : 'height',\n        style: StyleSheet.flatten([styles.flex1, suggestionsContainerStyle]),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 504,\n          columnNumber: 15\n        }\n      }, this.getComponent()) : React.createElement(KeyboardAvoidingView, {\n        behavior: Platform.OS === 'ios' ? 'padding' : 'height',\n        style: StyleSheet.flatten([styles.flex1, suggestionsContainerStyle]),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 514,\n          columnNumber: 15\n        }\n      }, this.renderError(), this.renderNoSuggestion(), this.totalSuggestions.length ? React.createElement(FlatList, {\n        ref: this.flatListRef,\n        data: this.totalSuggestions.slice(0, size),\n        keyboardShouldPersistTaps: 'handled',\n        keyExtractor: function keyExtractor(item) {\n          return item.label;\n        },\n        ItemSeparatorComponent: this.renderItemSeparator,\n        renderItem: this.renderSuggestionItem,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 524,\n          columnNumber: 19\n        }\n      }) : null, !this.componentInstance.value && recentSearches && recentSearches.length && React.createElement(FlatList, {\n        data: (recentSearches || []).slice(0, size),\n        keyboardShouldPersistTaps: 'handled',\n        keyExtractor: function keyExtractor(item) {\n          return item.label;\n        },\n        ItemSeparatorComponent: this.renderItemSeparator,\n        renderItem: function renderItem(rest) {\n          return _this3.renderSuggestionItem(_objectSpread({\n            isRecentSearch: true\n          }, rest));\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 536,\n          columnNumber: 21\n        }\n      })))));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var showModal = this.state.showModal;\n      var autosuggest = this.props.autosuggest;\n\n      if (!autosuggest) {\n        return this.renderSearchInput();\n      }\n\n      return showModal ? this.renderAutoSuggestView() : autosuggest && React.createElement(Pressable, {\n        onPress: this.openModal,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 649,\n          columnNumber: 11\n        }\n      }, this.renderSearchInput({\n        pointerEvents: 'none'\n      }));\n    }\n  }, {\n    key: \"componentInstance\",\n    get: function get() {\n      var id = this.props.id;\n      return this.context.getComponent(id);\n    }\n  }, {\n    key: \"popularSuggestionsList\",\n    get: function get() {\n      var suggestions = this.componentInstance.suggestions;\n      return (suggestions || []).filter(function (suggestion) {\n        return suggestion.source && suggestion.source._popular_suggestion;\n      });\n    }\n  }, {\n    key: \"suggestionsList\",\n    get: function get() {\n      var defaultSuggestions = this.props.defaultSuggestions;\n\n      if (!this.componentInstance.value && defaultSuggestions) {\n        return defaultSuggestions;\n      }\n\n      var suggestions = this.componentInstance.suggestions;\n      return (suggestions || []).filter(function (suggestion) {\n        return !(suggestion.source && suggestion.source._popular_suggestion);\n      });\n    }\n  }, {\n    key: \"stats\",\n    get: function get() {\n      var total = this.componentInstance.results.numberOfResults;\n      var _this$componentInstan2 = this.componentInstance.results,\n          time = _this$componentInstan2.time,\n          hidden = _this$componentInstan2.hidden,\n          promotedData = _this$componentInstan2.promotedData;\n      var size = this.props.size || 10;\n      return _objectSpread(_objectSpread({\n        numberOfResults: total\n      }, size > 0 ? {\n        numberOfPages: Math.ceil(total / size)\n      } : null), {}, {\n        time: time,\n        hidden: hidden,\n        promoted: promotedData && promotedData.length\n      });\n    }\n  }, {\n    key: \"totalSuggestions\",\n    get: function get() {\n      return [].concat(_toConsumableArray(this.suggestionsList), _toConsumableArray(this.popularSuggestionsList));\n    }\n  }, {\n    key: \"hasCustomRenderer\",\n    get: function get() {\n      return hasCustomRenderer(this.props);\n    }\n  }]);\n\n  return SearchBox;\n}(React.Component);\n\nSearchBox.contextType = SearchContext;\nSearchBox.propTypes = {\n  dataField: dataFieldDef,\n  aggregationField: string,\n  aggregationSize: number,\n  nestedField: string,\n  size: number,\n  debounce: wholeNumber,\n  queryFormat: queryFormat,\n  fuzziness: fuzzinessDef,\n  searchOperators: bool,\n  onValueSelected: func,\n  onAggregationData: func,\n  onError: func,\n  onResults: func,\n  defaultQuery: func,\n  customQuery: func,\n  onQueryChange: func,\n  appbaseConfig: appbaseConfigDef,\n  showDistinctSuggestions: bool,\n  queryString: bool,\n  onChange: func,\n  defaultSuggestions: arrayOf(object),\n  autosuggest: bool,\n  showAutoFill: bool,\n  enablePopularSuggestions: bool,\n  enableRecentSearches: bool,\n  maxPopularSuggestions: number,\n  distinctField: string,\n  distinctFieldConfig: object,\n  autoFillIcon: nodeType,\n  recentSearchIcon: nodeType,\n  goBackIcon: nodeType,\n  defaultValue: string,\n  value: string,\n  placeholder: string,\n  render: func,\n  renderItem: func,\n  renderNoSuggestion: titleDef,\n  renderError: titleDef,\n  style: object,\n  searchBarProps: object,\n  separatorStyle: oneOfType([object, array]),\n  searchHeaderStyle: oneOfType([object, array]),\n  suggestionsContainerStyle: oneOfType([object, array]),\n  error: any,\n  loading: bool,\n  results: object,\n  recentSearches: array,\n  enablePredictiveSuggestions: bool\n};\nSearchBox.defaultProps = {\n  maxPopularSuggestions: 5,\n  enablePopularSuggestions: false,\n  enableRecentSearches: false,\n  showAutoFill: true,\n  theme: defaultTheme,\n  placeholder: 'Search',\n  showIcon: true,\n  autosuggest: true,\n  debounce: 0,\n  showVoiceSearch: false,\n  className: '',\n  autoFocus: false,\n  downShiftProps: {},\n  showDistinctSuggestions: true,\n  enablePredictiveSuggestions: false,\n  value: undefined\n};\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1\n  },\n  itemStyle: {\n    flex: 1,\n    padding: 10,\n    flexDirection: 'row',\n    alignItems: 'center'\n  },\n  itemText: {\n    flex: 1,\n    padding: 10\n  },\n  autoFillIcon: {\n    justifyContent: 'flex-end'\n  },\n  itemSeparator: function itemSeparator(theme) {\n    return {\n      height: 0.5,\n      width: '100%',\n      backgroundColor: '#C8C8C8'\n    };\n  },\n  searchHeaderStyle: function searchHeaderStyle(theme) {\n    return {\n      height: 45,\n      justifyContent: 'center',\n      alignItems: 'flex-start',\n      paddingLeft: 10\n    };\n  },\n  flex1: {\n    flex: 1\n  }\n});\nexport default (function (props) {\n  return React.createElement(SearchComponent, _extends({\n    triggerQueryOnInit: false,\n    value: \"\"\n  }, props, {\n    subscribeTo: ['micStatus', 'error', 'requestPending', 'results', 'value', 'recentSearches'],\n    __self: _this4,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 776,\n      columnNumber: 3\n    }\n  }), function (_ref4) {\n    var error = _ref4.error,\n        loading = _ref4.loading,\n        results = _ref4.results,\n        value = _ref4.value,\n        recentSearches = _ref4.recentSearches;\n    return React.createElement(SearchBox, _extends({}, props, {\n      error: error,\n      loading: loading,\n      results: results,\n      recentSearches: recentSearches,\n      __self: _this4,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 791,\n        columnNumber: 9\n      }\n    }));\n  });\n});","map":{"version":3,"sources":["/Users/mohdashraf/Desktop/searchbox/node_modules/@appbaseio/react-native-searchbox/src/components/SearchBox/index.js"],"names":["React","any","bool","func","number","object","string","arrayOf","array","oneOfType","appbaseConfig","appbaseConfigDef","fuzziness","fuzzinessDef","queryFormat","title","titleDef","wholeNumber","dataField","dataFieldDef","Icon","renderNode","nodeType","defaultTheme","SearchComponent","debounce","debounceFunc","equals","getComponent","hasCustomRenderer","SearchContext","isFunction","SearchBar","causes","defaultGoBackIcon","theme","type","size","name","defaultRecentSearchIcon","defaultPopularSuggestionIcon","style","marginRight","defaultAutoFillIcon","SearchBox","props","context","closeModal","state","showModal","autoFillInProgress","clearState","setValue","value","openModal","enableRecentSearches","setState","setFocus","componentInstance","clearResults","getRecentSearches","_applySetter","prev","next","setterFunc","isPopularSuggestionsRender","error","loading","recentSearches","data","suggestionsList","triggerClickAnalytics","promotedData","results","customData","resultStats","stats","rawData","popularSuggestions","popularSuggestionsList","clickPosition","isSuggestion","recordAnalytics","recordClick","triggerQuery","triggerCustomQuery","stateChanges","triggerDefaultQuery","onInputChange","scrollToTop","flatListRef","current","scrollToOffset","animated","offset","isControlled","onChange","undefined","rest","autosuggest","onValueSelected","currentValue","cause","clearValue","CLEAR_VALUE","onSuggestionSelected","suggestion","_click_id","source","_id","SUGGESTION_SELECT","renderNoSuggestion","totalSuggestions","length","cb","handleSubmitEditing","e","text","nativeEvent","ENTER_PRESS","handleAutoFill","item","recentSearch","withTriggerQuery","renderSuggestionItem","isRecentSearch","renderItem","autoFillIcon","showAutoFill","recentSearchIcon","popularSuggestionIcon","isPredictiveSuggestion","normalText","highlightedText","exec","label","replaceAll","styles","itemStyle","onPress","_popular_suggestion","display","flexDirection","flex","fontWeight","itemText","renderItemSeparator","separatorStyle","StyleSheet","flatten","itemSeparator","renderError","defaultValue","onResults","searchbarRef","createRef","aggregationField","console","warn","prevProps","headers","nestedField","JSON","stringify","setTimeout","focus","isOpenWithModal","placeholder","searchBarProps","onBlur","onKeyPress","onFocus","goBackIcon","searchHeaderStyle","suggestionsContainerStyle","flex1","renderSearchInput","Platform","OS","slice","renderAutoSuggestView","pointerEvents","id","suggestions","filter","defaultSuggestions","total","numberOfResults","time","hidden","numberOfPages","Math","ceil","promoted","Component","contextType","propTypes","aggregationSize","searchOperators","onAggregationData","onError","defaultQuery","customQuery","onQueryChange","showDistinctSuggestions","queryString","enablePopularSuggestions","maxPopularSuggestions","distinctField","distinctFieldConfig","render","enablePredictiveSuggestions","defaultProps","showIcon","showVoiceSearch","className","autoFocus","downShiftProps","create","container","padding","alignItems","justifyContent","height","width","backgroundColor","paddingLeft"],"mappings":"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","sourcesContent":["import React from 'react';\nimport {\n  any,\n  bool,\n  func,\n  number,\n  object,\n  string,\n  arrayOf,\n  array,\n  oneOfType\n} from 'prop-types';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  SafeAreaView,\n  FlatList,\n  Modal,\n  Pressable,\n  KeyboardAvoidingView,\n  Platform,\n  TouchableOpacity\n} from 'react-native';\nimport {\n  appbaseConfig as appbaseConfigDef,\n  fuzziness as fuzzinessDef,\n  queryFormat,\n  title as titleDef,\n  wholeNumber,\n  dataField as dataFieldDef\n} from '../../utils/types';\nimport Icon from './SearchBar/Icon';\nimport { renderNode, nodeType } from './SearchBar/helpers';\nimport defaultTheme from './SearchBar/helpers/theme';\nimport SearchComponent from '../SearchComponent';\n\nimport {\n  debounce as debounceFunc,\n  equals,\n  getComponent,\n  hasCustomRenderer,\n  SearchContext,\n  isFunction\n} from '../../utils/helper';\nimport SearchBar from './SearchBar';\nimport causes from '../../utils/causes';\n\n// TODO: Change for android\nconst defaultGoBackIcon = theme => ({\n  type: 'ionicon',\n  size: 24,\n  name: 'ios-arrow-back'\n});\n\nconst defaultRecentSearchIcon = theme => ({\n  type: 'material',\n  size: 24,\n  name: 'history'\n});\n\nconst defaultPopularSuggestionIcon = theme => ({\n  type: 'material',\n  size: 24,\n  name: 'trending-up',\n  style: { marginRight: 10 }\n});\n\nconst defaultAutoFillIcon = theme => ({\n  type: 'feather',\n  size: 24,\n  name: 'arrow-up-left'\n});\n\nclass SearchBox extends React.Component {\n  static contextType = SearchContext;\n\n  constructor(props, context) {\n    super(props, context);\n    const { value, defaultValue } = props;\n    let currentValue = value || defaultValue || '';\n\n    this.state = {\n      showModal: false,\n      autoFillInProgress: false\n    };\n    // Set the value in searchbase instance\n    if (currentValue) {\n      this.componentInstance.setValue(currentValue, {\n        triggerDefaultQuery: false,\n        triggerCustomQuery: true,\n        stateChanges: true\n      });\n    }\n    if (this.componentInstance) {\n      const onResults = () => {\n        this.scrollToTop();\n      };\n      if (this.componentInstance.onResults) {\n        this.componentInstance.onResults = () => {\n          onResults();\n          this.componentInstance.onResults();\n        };\n      } else {\n        this.componentInstance.onResults = onResults;\n      }\n    }\n    this.searchbarRef = React.createRef();\n    this.flatListRef = React.createRef();\n  }\n\n  componentDidMount() {\n    const { aggregationField } = this.props;\n    if (aggregationField) {\n      console.warn(\n          'Warning(SearchBox): The `aggregationField` prop has been marked as deprecated, please use the `distinctField` prop instead.',\n      );\n    }\n  }\n\n  componentDidUpdate(prevProps) {\n    const {\n      dataField,\n      headers,\n      fuzziness,\n      nestedField,\n      appbaseConfig\n    } = this.props;\n    this._applySetter(prevProps.dataField, dataField, 'setDataField');\n    this._applySetter(prevProps.headers, headers, 'setHeaders');\n    this._applySetter(prevProps.fuzziness, fuzziness, 'setFuzziness');\n    this._applySetter(prevProps.nestedField, nestedField, 'setNestedField');\n    if (\n      JSON.stringify(prevProps.appbaseConfig) !== JSON.stringify(appbaseConfig)\n    ) {\n      if (this.componentInstance)\n        this.componentInstance.appbaseConfig = appbaseConfig;\n    }\n  }\n\n  closeModal = () => {\n    const { showModal, autoFillInProgress } = this.state;\n    if (showModal) {\n      this.clearState(() => {\n        if (autoFillInProgress) {\n          // Clear stale query\n          this.setValue({\n            value: ''\n          });\n        }\n      });\n    }\n  };\n\n  openModal = () => {\n    const { enableRecentSearches } = this.props;\n    const { showModal } = this.state;\n    if (!showModal) {\n      this.setState(\n        {\n          showModal: true\n        },\n        this.setFocus\n      );\n      // Refresh recent searches\n      if (enableRecentSearches) {\n        // Only fetch if value is empty\n        if (!this.componentInstance.value) {\n          // Empty suggestions\n          this.componentInstance.clearResults();\n          this.componentInstance.getRecentSearches();\n        }\n      }\n    }\n  };\n\n  get componentInstance() {\n    const { id } = this.props;\n    return this.context.getComponent(id);\n  }\n\n  get popularSuggestionsList() {\n    const suggestions = this.componentInstance.suggestions;\n    return (suggestions || []).filter(\n      suggestion => suggestion.source && suggestion.source._popular_suggestion\n    );\n  }\n\n  get suggestionsList() {\n    const { defaultSuggestions } = this.props;\n    if (!this.componentInstance.value && defaultSuggestions) {\n      return defaultSuggestions;\n    }\n    const suggestions = this.componentInstance.suggestions;\n    return (suggestions || []).filter(\n      suggestion =>\n        !(suggestion.source && suggestion.source._popular_suggestion)\n    );\n  }\n\n  get stats() {\n    const total = this.componentInstance.results.numberOfResults;\n    const { time, hidden, promotedData } = this.componentInstance.results;\n    const size = this.props.size || 10;\n    return {\n      numberOfResults: total,\n      ...(size > 0 ? { numberOfPages: Math.ceil(total / size) } : null),\n      time,\n      hidden,\n      promoted: promotedData && promotedData.length\n    };\n  }\n\n  get totalSuggestions() {\n    return [...this.suggestionsList, ...this.popularSuggestionsList];\n  }\n\n  _applySetter = (prev, next, setterFunc) => {\n    if (!equals(prev, next))\n      this.componentInstance && this.componentInstance[setterFunc](next);\n  };\n\n  getComponent = (isPopularSuggestionsRender = false) => {\n    const { error, loading, recentSearches } = this.props;\n    const data = {\n      error,\n      loading,\n      data: this.suggestionsList,\n      value: this.componentInstance.value,\n      triggerClickAnalytics: this.triggerClickAnalytics,\n      promotedData: this.componentInstance.results.promotedData,\n      customData: this.componentInstance.results.customData,\n      resultStats: this.stats,\n      rawData: this.componentInstance.results.rawData,\n      popularSuggestions: this.popularSuggestionsList,\n      recentSearches\n    };\n    return getComponent(data, this.props);\n  };\n\n  triggerClickAnalytics = (clickPosition, isSuggestion = true, value) => {\n    const { appbaseConfig } = this.props;\n    if (\n      !(appbaseConfig && appbaseConfig.recordAnalytics) ||\n      !this.componentInstance\n    )\n      return;\n    this.componentInstance.recordClick(\n      { [value]: clickPosition },\n      isSuggestion\n    );\n  };\n\n  get hasCustomRenderer() {\n    return hasCustomRenderer(this.props);\n  }\n\n  triggerQuery = () => {\n    this.componentInstance &&\n      this.componentInstance.setValue(this.props.value, {\n        triggerCustomQuery: true,\n        stateChanges: true\n      });\n  };\n\n  triggerCustomQuery = () => {\n    if (this.componentInstance) {\n      this.componentInstance.triggerCustomQuery();\n    }\n  };\n\n  triggerDefaultQuery = () => {\n    this.componentInstance && this.componentInstance.triggerDefaultQuery();\n  };\n\n  onInputChange = value => {\n    this.setValue({ value });\n  };\n\n  scrollToTop = () => {\n    this.flatListRef.current &&\n      this.flatListRef.current.scrollToOffset({ animated: true, offset: 0 });\n  };\n\n  isControlled = () => {\n    const { value, onChange } = this.props;\n    if (value !== undefined && onChange) {\n      return true;\n    }\n    return false;\n  };\n\n  setValue = ({ value, clearResults = true, ...rest }) => {\n    let triggerDefaultQuery = true;\n    const { autoFillInProgress } = this.state;\n    const { onChange, debounce, autosuggest } = this.props;\n    if (!autosuggest) {\n      triggerDefaultQuery = false;\n    } else if (rest.triggerDefaultQuery !== undefined) {\n      triggerDefaultQuery = rest.triggerDefaultQuery;\n    }\n    if (autoFillInProgress) {\n      this.setState({\n        autoFillInProgress: false\n      });\n    }\n    if (this.isControlled()) {\n      this.componentInstance.setValue(value, {\n        triggerDefaultQuery: !!rest.triggerDefaultQuery,\n        triggerCustomQuery: !!rest.triggerCustomQuery\n      });\n      onChange(value, this.componentInstance);\n    } else {\n      if (!value && clearResults) {\n        // Clear suggestions for empty value\n        this.componentInstance.clearResults();\n      }\n      if (debounce > 0) {\n        this.componentInstance.setValue(value, {\n          triggerDefaultQuery: false,\n          triggerCustomQuery: false,\n          stateChanges: true\n        });\n        // only fetch suggestions for value\n        if (value && triggerDefaultQuery) {\n          debounceFunc(this.triggerDefaultQuery, debounce);\n        }\n        if (!autosuggest) {\n          debounceFunc(this.triggerCustomQuery, debounce);\n        }\n        if (rest.triggerCustomQuery) {\n          this.triggerCustomQuery();\n        }\n      } else {\n        this.componentInstance.setValue(value || '', {\n          triggerCustomQuery: rest.triggerCustomQuery,\n          // only fetch suggestions for value\n          triggerDefaultQuery: !!value && triggerDefaultQuery,\n          stateChanges: true\n        });\n        if (!autosuggest) {\n          this.triggerCustomQuery();\n        }\n      }\n    }\n  };\n\n  onValueSelected = (currentValue = this.componentInstance.value, ...cause) => {\n    const { onValueSelected } = this.props;\n    if (onValueSelected) {\n      onValueSelected(currentValue, ...cause);\n    }\n  };\n\n  clearValue = () => {\n    this.setValue({ value: '', triggerCustomQuery: true });\n    this.onValueSelected(null, causes.CLEAR_VALUE);\n  };\n\n  onSuggestionSelected = suggestion => {\n    this.setValue({\n      value: suggestion && suggestion.value,\n      triggerCustomQuery: true\n    });\n    // Keyboard.dissmiss();\n    this.closeModal();\n    this.triggerClickAnalytics(\n      suggestion && suggestion._click_id,\n      true,\n      suggestion.source && suggestion.source._id\n    );\n    this.onValueSelected(\n      suggestion.value,\n      causes.SUGGESTION_SELECT,\n      suggestion.source\n    );\n  };\n\n  renderNoSuggestion = () => {\n    const { renderNoSuggestion, loading, error } = this.props;\n    const currentValue = this.componentInstance.value;\n    if (\n      renderNoSuggestion &&\n      !this.totalSuggestions.length &&\n      !loading &&\n      currentValue &&\n      !error\n    ) {\n      return typeof renderNoSuggestion === 'function'\n        ? renderNoSuggestion(currentValue)\n        : renderNoSuggestion;\n    }\n    return null;\n  };\n\n  clearState = (cb = () => null) => {\n    this.setState(\n      {\n        showModal: false,\n        autoFillInProgress: false\n      },\n      cb\n    );\n  };\n\n  handleSubmitEditing = e => {\n    const text = e.nativeEvent.text;\n    // if a suggestion was selected, delegate the handling\n    // to suggestion handler\n    this.clearState(() =>\n      this.setValue({\n        value: text,\n        triggerCustomQuery: true\n      })\n    );\n    this.onValueSelected(text, causes.ENTER_PRESS);\n  };\n\n  setFocus() {\n    setTimeout(() => {\n      if (this.searchbarRef.current) {\n        this.searchbarRef.current.focus();\n      }\n    }, 40);\n  }\n\n  handleAutoFill = (item, recentSearch) => {\n    this.setState(\n      {\n        autoFillInProgress: true\n      },\n      () => {\n        this.componentInstance.setValue(item.value);\n      }\n    );\n  };\n\n  withTriggerQuery = cb => {\n    if (cb) {\n      return e => cb(this.componentInstance, e);\n    }\n    return undefined;\n  };\n\n  renderSearchInput({ isOpenWithModal = false, ...rest } = {}) {\n    const { placeholder, theme, loading, style, searchBarProps, onBlur, onKeyPress, onFocus } = this.props;\n    const currentValue = this.componentInstance.value || '';\n    return (\n      <SearchBar\n        onChangeText={this.onInputChange}\n        onSubmitEditing={this.handleSubmitEditing}\n        onClear={this.clearValue}\n        placeholder={placeholder}\n        value={currentValue}\n        autoFocus={isOpenWithModal}\n        theme={theme}\n        showLoading={loading}\n        returnKeyType=\"search\"\n        ref={this.searchbarRef}\n        style={style}\n        onBlur={this.withTriggerQuery(onBlur)}\n        onFocus={this.withTriggerQuery(onFocus)}\n        onKeyPress={this.withTriggerQuery(onKeyPress)}\n        {...rest}\n        {...searchBarProps}\n      />\n    );\n  }\n\n  renderAutoSuggestView() {\n    const {\n      theme,\n      goBackIcon = defaultGoBackIcon(theme),\n      size,\n      searchHeaderStyle,\n      recentSearches,\n      suggestionsContainerStyle\n    } = this.props;\n    return (\n      <Modal\n        supportedOrientations={null}\n        transparent={false}\n        visible={this.state.showModal}\n        onRequestClose={this.closeModal}\n      >\n        <SafeAreaView style={styles.flex1}>\n          <View style={styles.flex1}>\n            <View\n              style={StyleSheet.flatten([\n                styles.searchHeaderStyle(theme),\n                searchHeaderStyle\n              ])}\n            >\n              {renderNode(Icon, goBackIcon, {\n                theme,\n                ...defaultGoBackIcon(theme),\n                onPress: this.closeModal\n              })}\n            </View>\n            {this.renderSearchInput({\n              isOpenWithModal: true\n            })}\n            {this.hasCustomRenderer ? (\n              <KeyboardAvoidingView\n                behavior={Platform.OS === 'ios' ? 'padding' : 'height'}\n                style={StyleSheet.flatten([\n                  styles.flex1,\n                  suggestionsContainerStyle\n                ])}\n              >\n                {this.getComponent()}\n              </KeyboardAvoidingView>\n            ) : (\n              <KeyboardAvoidingView\n                behavior={Platform.OS === 'ios' ? 'padding' : 'height'}\n                style={StyleSheet.flatten([\n                  styles.flex1,\n                  suggestionsContainerStyle\n                ])}\n              >\n                {this.renderError()}\n                {this.renderNoSuggestion()}\n                {this.totalSuggestions.length ? (\n                  <FlatList\n                    ref={this.flatListRef}\n                    data={this.totalSuggestions.slice(0, size)}\n                    keyboardShouldPersistTaps={'handled'}\n                    keyExtractor={item => item.label}\n                    ItemSeparatorComponent={this.renderItemSeparator}\n                    renderItem={this.renderSuggestionItem}\n                  />\n                ) : null}\n                {!this.componentInstance.value &&\n                  recentSearches &&\n                  recentSearches.length && (\n                    <FlatList\n                      data={(recentSearches || []).slice(0, size)}\n                      keyboardShouldPersistTaps={'handled'}\n                      keyExtractor={item => item.label}\n                      ItemSeparatorComponent={this.renderItemSeparator}\n                      renderItem={rest =>\n                        this.renderSuggestionItem({\n                          isRecentSearch: true,\n                          ...rest\n                        })\n                      }\n                    />\n                  )}\n              </KeyboardAvoidingView>\n            )}\n          </View>\n        </SafeAreaView>\n      </Modal>\n    );\n  }\n\n  renderSuggestionItem = ({ item, isRecentSearch }) => {\n    const {\n      renderItem,\n      theme,\n      autoFillIcon = defaultAutoFillIcon(theme),\n      showAutoFill,\n      recentSearchIcon = defaultRecentSearchIcon(theme),\n      popularSuggestionIcon = defaultPopularSuggestionIcon(theme)\n    } = this.props;\n    const { isPredictiveSuggestion } = item;\n    let normalText = '';\n    let highlightedText = '';\n    if (isPredictiveSuggestion) {\n      normalText = (/[^<]*/).exec(item.label)[0];\n      highlightedText = (/>[^<]*/).exec(item.label)[0].replaceAll('>', '');\n    }\n    if (renderItem) {\n      return renderItem(item, isRecentSearch);\n    }\n    return (\n      <View style={styles.itemStyle}>\n        {isRecentSearch\n          ? renderNode(Icon, recentSearchIcon, {\n              theme,\n              onPress: () => this.onSuggestionSelected(item),\n              ...defaultRecentSearchIcon(theme)\n            })\n          : null}\n        {item.source && item.source._popular_suggestion\n          ? renderNode(Icon, popularSuggestionIcon, {\n              theme,\n              onPress: () => this.onSuggestionSelected(item),\n              ...defaultPopularSuggestionIcon(theme)\n            })\n          : null}\n        {isPredictiveSuggestion ? (\n          <TouchableOpacity style={{display: 'flex', flexDirection: 'row', flex: 1}} onPress={() => this.onSuggestionSelected(item)}>\n            <Text>{normalText}</Text>\n            <Text style={{ fontWeight: '700' }} numberOfLines={1}>{highlightedText}</Text>\n          </TouchableOpacity>\n        ) : (\n          <Text\n            style={styles.itemText}\n            onPress={() => this.onSuggestionSelected(item)}\n            numberOfLines={1}\n          >\n            {item.label}\n          </Text>\n        )}\n        <View styles={styles.autoFillIcon}>\n          {showAutoFill\n            ? renderNode(Icon, autoFillIcon, {\n                theme,\n                onPress: () => this.handleAutoFill(item, isRecentSearch),\n                ...defaultAutoFillIcon(theme)\n              })\n            : null}\n        </View>\n      </View>\n    );\n  };\n\n  renderItemSeparator = () => {\n    const { separatorStyle, theme } = this.props;\n    return (\n      // Flat List Item Separator\n      <View\n        style={StyleSheet.flatten([\n          styles.itemSeparator(theme),\n          separatorStyle\n        ])}\n      />\n    );\n  };\n\n  renderError = () => {\n    const { renderError, error, loading } = this.props;\n    if (error && renderError && !loading) {\n      return isFunction(renderError) ? renderError(error) : renderError;\n    }\n    return null;\n  };\n\n  render() {\n    const { showModal } = this.state;\n    const { autosuggest } = this.props;\n    if (!autosuggest) {\n      return this.renderSearchInput();\n    }\n    return showModal\n      ? this.renderAutoSuggestView()\n      : autosuggest && (\n          <Pressable onPress={this.openModal}>\n            {this.renderSearchInput({\n              pointerEvents: 'none'\n            })}\n          </Pressable>\n        );\n  }\n}\n\nSearchBox.propTypes = {\n  // RS API\n  dataField: dataFieldDef,\n  aggregationField: string,\n  aggregationSize: number,\n  nestedField: string,\n  size: number,\n  debounce: wholeNumber,\n  // TODO: Implement later\n  // highlight: bool,\n  // highlightField,\n  // customHighlight: func,\n  queryFormat,\n  fuzziness: fuzzinessDef,\n  searchOperators: bool,\n  onValueSelected: func,\n  onAggregationData: func,\n  onError: func,\n  onResults: func,\n  defaultQuery: func,\n  customQuery: func,\n  onQueryChange: func,\n  appbaseConfig: appbaseConfigDef,\n  showDistinctSuggestions: bool,\n  queryString: bool,\n  onChange: func,\n  // Customize Suggestions\n  defaultSuggestions: arrayOf(object),\n  autosuggest: bool,\n  showAutoFill: bool,\n  enablePopularSuggestions: bool,\n  enableRecentSearches: bool,\n  maxPopularSuggestions: number,\n  distinctField: string,\n  distinctFieldConfig: object,\n  // icons\n  autoFillIcon: nodeType,\n  recentSearchIcon: nodeType,\n  goBackIcon: nodeType,\n  // Customize UI\n  defaultValue: string,\n  value: string,\n  placeholder: string,\n  render: func,\n  renderItem: func,\n  renderNoSuggestion: titleDef,\n  renderError: titleDef,\n  style: object,\n  searchBarProps: object,\n  separatorStyle: oneOfType([object, array]),\n  searchHeaderStyle: oneOfType([object, array]),\n  suggestionsContainerStyle: oneOfType([object, array]),\n  // Voice Search\n  // TODO: Implement voice search\n  // showVoiceSearch: bool,\n  // getMicInstance: func,\n  // renderMic: func,\n  // internal props\n  error: any,\n  loading: bool,\n  results: object,\n  recentSearches: array,\n  enablePredictiveSuggestions: bool\n};\n\nSearchBox.defaultProps = {\n  maxPopularSuggestions: 5,\n  enablePopularSuggestions: false,\n  enableRecentSearches: false,\n  showAutoFill: true,\n  theme: defaultTheme,\n  placeholder: 'Search',\n  showIcon: true,\n  autosuggest: true,\n  debounce: 0,\n  showVoiceSearch: false,\n  className: '',\n  autoFocus: false,\n  downShiftProps: {},\n  showDistinctSuggestions: true,\n  enablePredictiveSuggestions: false,\n  value: undefined\n};\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1\n  },\n  itemStyle: {\n    flex: 1,\n    padding: 10,\n    flexDirection: 'row',\n    alignItems: 'center'\n  },\n  itemText: {\n    flex: 1,\n    padding: 10\n  },\n  autoFillIcon: {\n    justifyContent: 'flex-end'\n  },\n  itemSeparator: theme => ({\n    height: 0.5,\n    width: '100%',\n    backgroundColor: '#C8C8C8'\n  }),\n  searchHeaderStyle: theme => ({\n    height: 45,\n    justifyContent: 'center',\n    alignItems: 'flex-start',\n    paddingLeft: 10\n  }),\n  flex1: {\n    flex: 1\n  }\n});\n\nexport default props => (\n  <SearchComponent\n    triggerQueryOnInit={false}\n    value=\"\" // Init value as empty\n    {...props}\n    subscribeTo={[\n      'micStatus',\n      'error',\n      'requestPending',\n      'results',\n      'value',\n      'recentSearches'\n    ]}\n  >\n    {({ error, loading, results, value, recentSearches }) => {\n      return (\n        <SearchBox\n          {...props}\n          error={error}\n          loading={loading}\n          results={results}\n          recentSearches={recentSearches}\n        />\n      );\n    }}\n  </SearchComponent>\n);\n"]},"metadata":{},"sourceType":"module"}